{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Resources": {
    "{alarmName}": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "AlarmName": "{resName} - Alarm",
        "ActionsEnabled": true,
        "OKActions": [],
        "AlarmActions": [
          "{snsTopic}"
        ],
        "InsufficientDataActions": [],
        "Dimensions": [],
        "EvaluationPeriods": 1,
        "DatapointsToAlarm": 1,
        "Threshold": 3,
        "ComparisonOperator": "GreaterThanThreshold",
        "TreatMissingData": "missing",
        "Metrics": [
          {
            "Id": "e1",
            "Label": "Error Percentage",
            "ReturnData": true,
            "Expression": "(m1/m2)*100"
          },
          {
            "Id": "m1",
            "ReturnData": false,
            "MetricStat": {
              "Metric": {
                "Namespace": "AWS/Lambda",
                "MetricName": "Errors",
                "Dimensions": [
                  {
                    "Name": "FunctionName",
                    "Value": "{resName}"
                  },
                  {
                    "Name": "Resource",
                    "Value": "{resName}"
                  }
                ]
              },
              "Period": 60,
              "Stat": "Sum"
            }
          },
          {
            "Id": "m2",
            "ReturnData": false,
            "MetricStat": {
              "Metric": {
                "Namespace": "AWS/Lambda",
                "MetricName": "Invocations",
                "Dimensions": [
                  {
                    "Name": "FunctionName",
                    "Value": "{resName}"
                  },
                  {
                    "Name": "Resource",
                    "Value": "{resName}"
                  }
                ]
              },
              "Period": 60,
              "Stat": "Sum"
            }
          }
        ]
      }
    }
  }
}